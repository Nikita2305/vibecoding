# TravelVid - Анимация маршрутов путешествий

Веб-приложение для визуализации анимированных маршрутов путешествий. Объект (поезд/машина/самолёт) движется по глобусу между городами, при прибытии появляется табличка с названием города.

## Быстрый старт

### 1. Запуск из консоли

```bash
node cli/serve.js --input example-route.json
```

Или через npm:

```bash
npm start serve -- --input example-route.json
```

### 2. Открой браузер

Сервер автоматически откроет адрес (по умолчанию `http://localhost:8000`). Если нет - открой вручную.

### 3. Нажми кнопку "Воспроизвести"

На странице будет только кнопка запуска анимации. Все настройки задаются через JSON файл.

## Использование

### Запуск сервера

```bash
# Базовый запуск
node cli/serve.js --input example-route.json

# С указанием порта
node cli/serve.js --input example-route.json --port 3000
```

### Контролы в браузере

- **▶️ Воспроизвести / ⏸️ Пауза** — запуск/остановка анимации
- **Время** — отображение текущего времени и общей длительности

## Формат входных данных

### JSON

```json
{
  "video": {
    "duration_sec": 45,
    "fps": 30,
    "resolution": "1080x1920",
    "map_style": "dark",
    "language": "ru"
  },
  "route": [
    {"city": "Warsaw", "country": "Poland"},
    {"city": "Berlin", "country": "Germany", "transport": "train"},
    {"city": "Paris", "country": "France", "transport": "plane"},
    {"city": "Lyon", "country": "France", "transport": "car"}
  ]
}
```

**Правила:**
- `route[0]` — стартовая точка без `transport`
- Для `route[i]` (i>0) поле `transport` описывает способ перемещения от `route[i-1]` до `route[i]`
- `transport` может быть: `plane`, `train`, `car`

**Параметры видео:**
- `duration_sec` (обязательно) — длительность анимации в секундах
- `fps` (по умолчанию 30) — кадров в секунду (для информации)
- `resolution` (по умолчанию 1080x1920) — разрешение (для информации)
- `map_style` (по умолчанию dark) — стиль карты (dark/light)
- `language` (по умолчанию ru) — язык для геокодинга и подписей

## Особенности

- **Great-circle маршруты**: самолеты по дуге, поезда/машины ближе к поверхности
- **Анимация табличек**: плавное появление с подсветкой при прибытии
- **Вертикальный формат**: оптимизировано для 9:16
- **Автоматический геокодинг**: координаты городов определяются автоматически

## Запись видео

Для записи видео используй встроенные инструменты системы:

- **macOS**: QuickTime Player → Новая запись экрана (⌘⇧5)
- **Windows**: Xbox Game Bar (Win+G) или OBS Studio
- **Linux**: OBS Studio или SimpleScreenRecorder

## Структура проекта

```
.
├── index.html          # Главная страница с контролами
├── app/
│   └── renderer.js    # Логика рендеринга и анимации
├── cli/
│   ├── serve.js       # Сервер для запуска из консоли
│   ├── input-parser.js # Парсинг JSON файлов
│   ├── geocoder.js    # Геокодинг городов
│   └── timeline.js    # Расчет таймингов
├── example-route.json # Пример входного файла
└── README.md          # Документация
```

## Технические детали

- **Mapbox GL JS** для отображения карты
- **OpenStreetMap** тайлы для карты (работает без токена)
- **Nominatim API** для геокодинга
- **Node.js** для сервера и геокодинга

### Опционально: Mapbox токен

Для лучшего качества карты можно использовать Mapbox токен (не обязательно):

1. Получи бесплатный токен на [mapbox.com](https://account.mapbox.com/)
2. Создай файл `.env` в корне проекта:
   ```
   MAPBOX_TOKEN=твой_токен_здесь
   ```

Без токена используется OpenStreetMap, что тоже работает отлично!

## Лицензия

MIT
